(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5220],{9252:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/use-cases/cryptos-currency",function(){return r(986)}])},986:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return l}});var t=r(5893),c=r(1644),s=r(8563),i=r(8113);let o=function(e){let{children:n}=e;return(0,t.jsx)(s.Z,{children:n})};function a(e){let n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{children:"Endpoint"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"/cryptos/{currency}\n"})}),"\n",(0,t.jsx)(n.h2,{children:"Advanced manipulation with JMESPath"}),"\n",(0,t.jsxs)(n.p,{children:["This use case demonstrates a complex manipulation of data using an expression. It queries a CoinGecko API endpoint (",(0,t.jsx)(n.a,{href:"https://api.coingecko.com/api/v3/coins/markets?vs_currency=EUR&order=market_cap_desc&per_page=100&page=1&sparkline=false",children:"see the raw data"}),") that returns data for over 100 cryptocurrencies. Each cryptocurrency returns an object like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'{\n  "id": "bitcoin",\n  "symbol": "btc",\n  "name": "Bitcoin",\n  "image": "https://coin-images.coingecko.com/coins/images/1/large/bitcoin.png?1696501400",\n  "current_price": 102266,\n  "market_cap": 2024218735768,\n  "price_change_percentage_24h": 2.72102,\n  ...19 fields more\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Our frontend will use just 5 fields and a shortened list with a slice of 5 currencies instead of the 100 currencies and over 25+ fields each."}),"\n",(0,t.jsxs)(n.p,{children:["To accomplish this modification, the ",(0,t.jsx)(n.code,{children:"/cryptos/{currency}"})," use case applies a JMESPath expression that transforms the data. It looks like this (break lines for simplified reading, must be a one-liner):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"reverse(\n    sort_by(\n      collection[:5], &name\n    )\n)[*].{\n    name: name,\n    token: symbol,\n    price: current_price,\n    price_change: price_change_percentage_24h,\n    market_cap: market_cap\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The final part of the expression ",(0,t.jsx)(n.code,{children:"[*].{}"})," takes all elements from the response array and projects a new object, renaming fields and taking only the desired ones  ",(0,t.jsx)(n.code,{children:"name"}),", ",(0,t.jsx)(n.code,{children:"token"}),", ",(0,t.jsx)(n.code,{children:"price"}),", ",(0,t.jsx)(n.code,{children:"price_change"}),", and ",(0,t.jsx)(n.code,{children:"market_cap"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Then, it sorts the resulting collection by ",(0,t.jsx)(n.code,{children:"&name"})," (it could be the ",(0,t.jsx)(n.code,{children:"market_cap"})," or anything else) with the expression ",(0,t.jsx)(n.code,{children:"sort_by()"})," and then flips the order entirely with ",(0,t.jsx)(n.code,{children:"reverse()"}),"."]}),"\n",(0,t.jsx)(n.h2,{children:"Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.krakend.io/docs/enterprise/endpoints/jmespath/",children:"JMESPath documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://play.jmespath.org/",children:"Interactive JMESPath playground"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Write the EUR or USD currency, and open the link in the browser or cURL:"}),"\n",(0,t.jsx)(i.Z,{endpoint:"http://localhost:8080/cryptos/",placeholder:"currency"})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsx)(o,{...e,children:(0,t.jsx)(a,{...e})})}},8113:function(e,n,r){"use strict";var t=r(5893),c=r(7294);n.Z=e=>{let{endpoint:n,placeholder:r,helpText:s}=e,i=(0,c.useRef)(null),[o,a]=(0,c.useState)("Copy"),[l,d]=(0,c.useState)(!1);return(0,t.jsxs)("div",{className:"not-prose",children:[(0,t.jsxs)("div",{className:"bg-white py-2 px-4 rounded-md flex flex-col sm:flex-row sm:items-center sm:justify-between",onClick:()=>{i.current&&i.current.focus()},children:[(0,t.jsxs)("div",{className:"flex text-brand-neutral-600 w-9/12",children:[(0,t.jsx)("p",{children:n||""}),(0,t.jsx)("input",{ref:i,type:"text",placeholder:r,className:"focus:outline-none w-full"})]}),(0,t.jsx)("button",{className:"bg-brand-neutral-900 text-white rounded-md px-6 py-2 mt-4 sm:mt-0 ".concat(l?"bg-blue-500":""),onClick:()=>{var e;let r=(null===(e=i.current)||void 0===e?void 0:e.value)||"",t="".concat(n).concat(r);navigator.clipboard.writeText(t).then(()=>{a("Copied!"),d(!0),setTimeout(()=>{a("Copy"),d(!1)},2e3)}).catch(e=>{console.error("Failed to copy:",e)})},children:o})]}),s&&(0,t.jsx)("small",{className:"mt-2 text-sm font-normal",children:s})]})}}},function(e){e.O(0,[9814,2681,182,6103,2888,9774,179],function(){return e(e.s=9252)}),_N_E=e.O()}]);