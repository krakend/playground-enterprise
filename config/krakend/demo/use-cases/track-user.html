<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Security policy engine for requests, responses and claim checking | KrakenD Playground</title><meta name="next-head-count" content="3"/><link rel="preload" href="/demo/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/demo/_next/static/css/1b998d4865185eab.css" as="style"/><link rel="stylesheet" href="/demo/_next/static/css/1b998d4865185eab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/demo/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/demo/_next/static/chunks/webpack-f6751f6d5bd64179.js" defer=""></script><script src="/demo/_next/static/chunks/framework-0995a3e8436ddc4f.js" defer=""></script><script src="/demo/_next/static/chunks/main-948a1c35d67c81ce.js" defer=""></script><script src="/demo/_next/static/chunks/pages/_app-8f35f06b58243b9e.js" defer=""></script><script src="/demo/_next/static/chunks/9814-ed9b5e85fe153376.js" defer=""></script><script src="/demo/_next/static/chunks/2681-786ec7c79bfe6f76.js" defer=""></script><script src="/demo/_next/static/chunks/182-f65b35f21b5334ee.js" defer=""></script><script src="/demo/_next/static/chunks/6103-f18791462d275ea0.js" defer=""></script><script src="/demo/_next/static/chunks/pages/use-cases/track-user-72e7f78c423a6019.js" defer=""></script><script src="/demo/_next/static/Hs-pVs0vfU4tA_WWjAIJ3/_buildManifest.js" defer=""></script><script src="/demo/_next/static/Hs-pVs0vfU4tA_WWjAIJ3/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="__className_5e8dbd bg-brand-neutral-900"><header class="bg-brand-neutral-900"><div class="container--boxed-xl"><div class="relative px-0 py-4 lg:py-6  "><div class="text-white flex items-center justify-between h-full"><div class="relative z-10"><a href="/demo/use-cases/track-user"><svg xmlns="http://www.w3.org/2000/svg" width="157" height="31" fill="none" aria-label="KrakenD"><g fill="#fff" clip-path="url(#logo-krakend-bw_svg__a)"><path d="M15.024.928c4.024 0 7.796 1.531 10.619 4.31 2.84 2.797 4.405 6.555 4.405 10.58 0 8.332-6.74 15.11-15.024 15.11-6.178 0-11.497-3.77-13.803-9.143l-.059-.13A15.2 15.2 0 0 1 0 15.818c0-4.025 1.565-7.783 4.405-10.58C7.23 2.46 11 .929 15.024.929zm1.051 4.44-.201.029-.017.002.01-.001.007-.001.203-.023-.21.024-.014.002-.02.003.244-.029c-4.6.48-6.644 3.863-6.628 7.002q.004.536.088 1.05a7.77 7.77 0 0 1 4.854-1.682c4.308 0 7.77 3.474 7.88 7.91.053 2.12-.676 4.023-2.108 5.5-1.628 1.68-3.992 2.644-6.694 2.743-.262.018-.52.023-.772.023-2.542 0-4.568-.502-6.168-1.221a13.64 13.64 0 0 0 8.495 2.96c7.588 0 13.762-6.21 13.762-13.841.001-1.26-.17-2.516-.51-3.73l-.132-.441-.161-.28c-3.09-5.176-8.104-6.501-11.908-5.999m-1.051-3.17c-3.692 0-7.15 1.402-9.736 3.948-2.596 2.556-4.025 5.991-4.025 9.672 0 1.941.4 3.79 1.12 5.469.42.855 3.04 5.482 10.624 5.36v-.012c2.551 0 4.772-.84 6.252-2.368 1.19-1.226 1.795-2.81 1.75-4.582a7 7 0 0 0-.102-1.05 7.77 7.77 0 0 1-4.84 1.67c-4.323 0-7.858-3.554-7.88-7.923-.022-4.318 3.063-7.678 7.531-8.245l-.076.011c2.636-.408 5.84-.023 8.722 1.727l.329.207-.204-.195c-2.554-2.382-5.9-3.689-9.465-3.689m-4.598 17.829a2.6 2.6 0 0 1 2.59 2.604 2.6 2.6 0 0 1-2.59 2.604 2.6 2.6 0 0 1-2.59-2.604 2.6 2.6 0 0 1 2.59-2.604m0 1.27c-.732 0-1.327.598-1.327 1.334 0 .735.596 1.334 1.327 1.334.732 0 1.327-.599 1.327-1.334s-.595-1.335-1.327-1.335zm-4.945-6.668a3.01 3.01 0 0 1 2.997 3.014 3.01 3.01 0 0 1-2.997 3.014 3.01 3.01 0 0 1-2.996-3.014 3.01 3.01 0 0 1 2.996-3.014m20.023.057a2.6 2.6 0 0 1 2.589 2.605 2.6 2.6 0 0 1-2.59 2.604 2.6 2.6 0 0 1-2.589-2.604 2.6 2.6 0 0 1 2.59-2.605M5.48 15.9a1.74 1.74 0 0 0-1.734 1.744c0 .961.778 1.744 1.734 1.744.957 0 1.735-.783 1.735-1.744 0-.962-.778-1.744-1.735-1.744m8.91-2.886a6.54 6.54 0 0 0-4.487 1.764c.968 2.49 3.37 4.258 6.163 4.258a6.53 6.53 0 0 0 4.469-1.746c-.977-2.525-3.349-4.276-6.145-4.276m11.113 2.943c-.732 0-1.327.598-1.327 1.334s.595 1.335 1.327 1.335c.731 0 1.327-.599 1.327-1.335s-.596-1.334-1.327-1.334m-3.276-8.049a3.01 3.01 0 0 1 2.997 3.014 3.01 3.01 0 0 1-2.997 3.014 3.01 3.01 0 0 1-2.997-3.014 3.01 3.01 0 0 1 2.997-3.014M5.445 8.67a2.285 2.285 0 0 1 2.276 2.29 2.285 2.285 0 0 1-2.276 2.287 2.285 2.285 0 0 1-2.276-2.288A2.285 2.285 0 0 1 5.445 8.67m16.783.508c-.956 0-1.734.783-1.734 1.744 0 .962.778 1.745 1.734 1.745s1.734-.783 1.734-1.745a1.74 1.74 0 0 0-1.734-1.744M5.445 9.94c-.559 0-1.013.457-1.013 1.02 0 .561.454 1.018 1.013 1.018s1.013-.457 1.013-1.019S6.004 9.94 5.445 9.94m10.293-3.424a2.285 2.285 0 0 1 2.275 2.289 2.285 2.285 0 0 1-2.275 2.288 2.285 2.285 0 0 1-2.276-2.288 2.285 2.285 0 0 1 2.276-2.289m0 1.27c-.56 0-1.014.456-1.014 1.018s.455 1.019 1.014 1.019 1.013-.457 1.013-1.019-.455-1.018-1.013-1.018m24.326.877 4.742-2.735v9.76l5.554-6.21h5.68l-6.366 6.719 6.583 10.35h-5.429l-4.368-6.975-1.654 1.784v5.19h-4.742zm17.221.814h4.743v3.44c.967-2.357 2.527-3.885 5.335-3.758v5.063h-.25c-3.15 0-5.085 1.943-5.085 6.019v6.305h-4.743zM67.3 21.642v-.064c0-3.726 2.777-5.445 6.74-5.445 1.685 0 2.901.286 4.087.7v-.286c0-2.006-1.217-3.12-3.588-3.12-1.81 0-3.09.35-4.618.923l-1.185-3.694c1.84-.828 3.65-1.37 6.49-1.37 2.589 0 4.461.701 5.647 1.911 1.248 1.274 1.81 3.153 1.81 5.445v9.904h-4.587V24.7c-1.155 1.306-2.746 2.166-5.055 2.166-3.15 0-5.74-1.848-5.74-5.223zm10.89-1.115v-.86c-.811-.382-1.873-.636-3.027-.636-2.028 0-3.276.828-3.276 2.356v.064c0 1.306 1.06 2.07 2.59 2.07 2.215 0 3.713-1.242 3.713-2.994m6.858-11.864 4.743-2.735v9.76l5.554-6.21h5.678l-6.365 6.719 6.584 10.35h-5.43l-4.368-6.975-1.653 1.784v5.19h-4.743z"></path><path d="M100.68 18.107v-.064c0-4.872 3.4-8.884 8.267-8.884 5.585 0 8.144 4.426 8.144 9.267 0 .382-.031.828-.063 1.273H105.39c.468 2.198 1.966 3.344 4.088 3.344 1.59 0 2.746-.51 4.056-1.75l2.714 2.45c-1.56 1.975-3.806 3.185-6.832 3.185-5.024 0-8.737-3.598-8.737-8.82zm11.793-1.432c-.28-2.166-1.529-3.63-3.526-3.63-1.966 0-3.244 1.432-3.619 3.63zm6.422-7.198h4.742v2.421c1.092-1.433 2.496-2.739 4.899-2.739 3.588 0 5.679 2.42 5.679 6.337v11.05h-4.743v-9.521c0-2.293-1.06-3.471-2.87-3.471s-2.965 1.178-2.965 3.47v9.522h-4.742zm22.868-3.549h3.511c6.491 0 10.976 4.315 10.976 9.943v.057c0 5.629-4.485 10-10.976 10h-8.054V9.899zm3.511 16.029c3.718 0 6.226-2.429 6.226-5.972v-.057c0-3.543-2.508-6.029-6.226-6.029h-3.51v12.058z"></path></g><defs><clipPath id="logo-krakend-bw_svg__a"><path fill="#fff" d="M0 0h157v31H0z"></path></clipPath></defs></svg></a></div><nav class="flex items-center justify-end"><ul class="flex gap-3 md:gap-6 items-center justify-between"><li><a class="font-medium text-base hover:underline" target="_blank" rel="noopener" href="https://www.krakend.io/docs/"><span class="flex items-center gap-1">Docs<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"><path fill="#fff" fill-rule="evenodd" d="M12.8 13.867c.59 0 1.067-.478 1.067-1.067V3.2c0-.59-.478-1.067-1.067-1.067H3.2c-.59 0-1.067.478-1.067 1.067v3.733a.533.533 0 0 0 1.067 0V3.2h9.6v9.6H9.067a.533.533 0 0 0 0 1.067zM9.6 6.933v3.2a.533.533 0 1 1-1.067 0V8.221l-5.49 5.49a.533.533 0 0 1-.753-.755l5.49-5.49H5.866a.533.533 0 1 1 0-1.066h3.2a.53.53 0 0 1 .533.53" clip-rule="evenodd"></path></svg></span></a></li><li><a class="font-medium text-base hover:underline" href="https://www.krakend.io"><span class="flex items-center gap-1">Website<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"><path fill="#fff" fill-rule="evenodd" d="M12.8 13.867c.59 0 1.067-.478 1.067-1.067V3.2c0-.59-.478-1.067-1.067-1.067H3.2c-.59 0-1.067.478-1.067 1.067v3.733a.533.533 0 0 0 1.067 0V3.2h9.6v9.6H9.067a.533.533 0 0 0 0 1.067zM9.6 6.933v3.2a.533.533 0 1 1-1.067 0V8.221l-5.49 5.49a.533.533 0 0 1-.753-.755l5.49-5.49H5.866a.533.533 0 1 1 0-1.066h3.2a.53.53 0 0 1 .533.53" clip-rule="evenodd"></path></svg></span></a></li></ul></nav></div></div></div></header><div class="bg-brand-neutral-900 text-white"><div class="container--boxed-xl py-8"><button class="bg-brand-neutral-600 hover:scale-95 transition-transform rounded-full px-4 py-2 flex items-center justify-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M17 10a.75.75 0 0 1-.75.75H5.612l4.158 3.96a.75.75 0 1 1-1.04 1.08l-5.5-5.25a.75.75 0 0 1 0-1.08l5.5-5.25a.75.75 0 1 1 1.04 1.08L5.612 9.25H16.25A.75.75 0 0 1 17 10Z" clip-rule="evenodd"></path></svg><span class="text-base">Go back</span></button><div class="mt-10"><p class="uppercase tracking-wider text-sm text-brand-neutral-300 mb-2">Feature</p><h1 class="heading--h2 mb-10">Security policy engine for requests, responses and claim checking</h1><div class="flex flex-col lg:flex-row gap-12"><div class="lg:w-1/2 overflow-auto"><p class="font-semibold mb-2">Endpoint Configuration</p><pre class="text-sm relative"><button class="absolute right-2 top-3 sm:right-6 sm:top-4 icon text-brand-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" class="copy_svg__h-6 copy_svg__w-6 copy_svg__inline" viewBox="0 0 24 24" width="20" height="20"><g fill="none" fill-rule="evenodd"><path d="M0 .13h24v24H0z"></path><g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16.2 7.538v-.91a1.2 1.2 0 0 0-.351-.849L13.55 3.482a1.2 1.2 0 0 0-.848-.352H6.2A1.2 1.2 0 0 0 5 4.33v11.2a1.2 1.2 0 0 0 1.2 1.2h2.397" opacity="0.7"></path><path d="M19.8 19.93a1.2 1.2 0 0 1-1.2 1.2H9.8a1.2 1.2 0 0 1-1.2-1.2V8.73a1.2 1.2 0 0 1 1.2-1.2h6.504a1.2 1.2 0 0 1 .848.352l2.297 2.297a1.2 1.2 0 0 1 .351.848z"></path></g></g></svg></button><code class="language-json">{
  &quot;@comment&quot;: &quot;Feature: Security policy engine for requests, responses and claim checking&quot;,
  &quot;endpoint&quot;: &quot;/track-user&quot;,
  &quot;@test_with&quot;: &quot;curl -iG -H&#x27;Cookie: GDPR=yes&#x27; &#x27;http://localhost:8080/track-user&#x27;&quot;,
  &quot;input_headers&quot;: [
    &quot;Cookie&quot;
  ],
  &quot;backend&quot;: [
    {
      &quot;host&quot;: [
        &quot;http://localhost:8080&quot;
      ],
      &quot;url_pattern&quot;: &quot;/__debug/cookie&quot;
    }
  ],
  &quot;extra_config&quot;: {
    &quot;security/policies&quot;: {
      &quot;req&quot;: {
        &quot;policies&quot;: [
          &quot;getCookie(&#x27;GDPR&#x27;) == &#x27;yes&#x27;&quot;
        ],
        &quot;error&quot;: {
          &quot;body&quot;: &quot;User did not accept the cookie and tracking is not allowed&quot;,
          &quot;status&quot;: 403
        }
      }
    }
  }
}</code></pre></div><div class="lg:w-1/2"><div class="prose--mdx"><h2>Endpoint</h2>
<pre><code class="language-http">/track-user
</code></pre>
<h2>Security Policies</h2>
<p>The <code>/track-user</code> endpoint completes only if the user is passing a request with a Cookie setting <code>GDPR=yes</code>. If the cookie is missing or with a different value, then it replies with a <code>403</code> status code.</p>
<p>The policies engine lets you write custom rules validated on runtime during requests, responses, and token validation. The policies allow you to implement all sorts of validations and user access control, from parameter compliance, to RBAC (Role-Based Access Control) and ABAC (Attribute-Based Access Control) strategies.</p>
<p>For example, access the endpoint with:</p>
<pre><code>curl -iG -H&#x27;Cookie: GDPR=yes&#x27; &#x27;http://localhost:8080/track-user&#x27;
</code></pre>
<p>Or get a rejection with:</p>
<pre><code>curl -iG &#x27;http://localhost:8080/track-user&#x27;
</code></pre>
<p>See the <a href="https://www.krakend.io/docs/enterprise/security-policies/">Security Policies documentation</a></p></div></div></div></div></div></div><footer class="bg-brand-neutral-900"><div class="container--boxed-xl flex flex-col items-center justify-between w-full"><div class="border-brand-neutral-600 border-t w-full"></div><div class="relative px-0 py-4 lg:pb-10 lg:pt-8 w-full"><div class=" text-white flex items-center justify-between"><p class="text-brand-neutral-300 text-sm">Â© 2017 - <!-- -->2025<!-- --> KRAKEND S.L.</p></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/use-cases/track-user","query":{},"buildId":"Hs-pVs0vfU4tA_WWjAIJ3","assetPrefix":"/demo","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>